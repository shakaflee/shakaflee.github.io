---
layout: post
title: 尝试用GPT炒股获利
date: 2023-09-12 06:00:00 +0800
excerpt: 最高400%利润
tag: share
cover: /assets/images/posts/100104.png
description: 尝试用GPT炒股获利：最高400%利润
permalink: /100104
---


# {{ page.title }}


近期一篇论文《Can ChatGPT Forecast Stock Price Movements? Return Predictability and Large Language Models》（中文翻译为《ChatGPT能够预测股票价格走势吗？回报可预测性和大型语言模型》）引发热议，作者是佛罗里达大学的教授Alejandro Lopez-Lira和Yuehua Tang。在这篇论文中，ChatGPT解锁了新玩法，用来预测股价走势并按预测进行投资，最高的收益率达到了400%！

## 1 论文的基本思路

通过使用ChatGPT和其他大型语言模型预测股票市场回报方面的潜力。使用ChatGPT来判断某个新闻标题对公司股票价格是好消息、坏消息还是无关紧要的消息，然后标定对应的分数，通过计算并记录这些“ChatGPT分数”与随后的每日股市回报之间的正相关性，来预测股价走势。

## 2 数据

论文使用两个主要数据集进行分析：证券价格研究中心(CRSP)的每日回报和RavenPack的新闻标题。CRSP daily returns数据集（CRSP - The Center for Research in Security Prices）包含了在美国主要证券交易所上市的大范围公司的每日股票收益信息，包括股票价格、交易量和市值的数据。来自RavenPack的数据集包括来自各种来源的新闻标题，如主要新闻机构、财经新闻网站和社交媒体平台。

论文使用的样本包括在纽约证券交易所(NYSE)、美国证券交易商协会自动报价(NASDAQ)和美国证券交易所(AMEX)上市的所有公司，使用股票代码为10或11的普通股。其中至少有一篇新闻报道被Ravenpack（一个著名的新闻情绪分析数据提供商）道琼斯版报道。

使用的数据抽样窗口特意选在2021年10月份到2022年12月份之间，以避免导致数据泄露，从而可以对其预测能力进行更准确的评估。

## 3 数据预处理

论文使用RavenPack提供的“相关性分数”作为新闻与特定公司的相关程度的指标。为了避免重复的新闻，研究要求“事件相似天数”超过90，以确保只捕获有关公司的新信息，此外，还消除了同一天同一公司的重复标题和极其相似的标题，因此样本具有100的相关性分数，限制为完整的文章和新闻稿。通过使用最优字符串对齐度量（也称为受限Damerau-Levenshtein距离）来衡量标题相似性，并删除同一天同一公司相似度大于0.6的标题。这些过滤技术不会引入任何前瞻性偏差，因为RavenPack在接收到所有新闻文章后在毫秒内评估所有新闻文章，因此，在新闻发布时即可获得所有信息。

ChatGPT提示：
在论文中给ChatGPT编写了以下提示：

> 请忘记之前的指令。假装自己是一位金融专家，具有股票推荐经验。在第一行回答“YES”（好消息），“NO”（坏消息），或者“UNKNOWN”（不确定）。接下来，请用一句简短的话详细说明。这个标题对于该公司在特定时期的股票价格是好消息还是坏消息？（注意：company name和term term由具体上下文决定，此处为变量）

在此提示中，ChatGPT担当了具有股票推荐经验的金融专家角色。在查询过程中，术语“公司名称”和“标题”被公司名称和各自的标题所替代。Term既对应短期也对应长期。该提示是专门为财务分析而设计的，并要求ChatGPT评估给定的新闻标题及其在短期内对公司股价的潜在影响。如果消息对股价有利，ChatGPT被要求回答“是”，如果消息不好，回答“否”，如果消息不确定，回答“未知”。然后，ChatGPT被要求用一句话提供一个简洁的解释来支持自己的答案。提示明确指出，新闻标题是提供给ChatGPT的唯一信息来源。隐含的假设是，新闻标题包含了足以让金融行业专家合理评估其对股价影响的信息。

> 例如，考虑以下关于Oracle的标题：Rimini Street因诉Oracle案被罚款63万美元。 问题要求：请忘记之前的指令。假装自己是一位金融专家，具有股票推荐经验。在第一行回答“YES”（好消息），“NO”（坏消息）或者“UNKNOWN”（不确定）。接下来，请用一句简短的话详细说明。这个标题对于Oracle在短期内的股票价格是好消息还是坏消息？ 标题：Rimini Street因诉Oracle案被罚款63万美元。 ChatGPT的回答：YES。对Rimini Street的罚款有可能提升投资者对Oracle保护知识产权的能力的信心，并增加对其产品和服务的需求。

## 4 ChatGPT问答例子

实证：
研究人员将每个标题转换为ChatGPT分数，其中“YES”映射到1，“UNKNOWN”映射到0，“NO”映射到-1。如果一家公司在同一天有多个标题，则取平均分数。他们将分数滞后一天以评估回报的可预测性。然后，他们在ChatGPT分数上运行线性回归，并将其与RavenPack提供的情感分数进行比较。值得注意的是，他们在新闻可用性方面非常保守。如果新闻在交易所收盘后报告，则假定新闻在次日开盘交易时可用。

研究人员使用新闻标题数据和生成的情感分数，发现ChatGPT情感分数与样本中股票的随后日回报之间存在强烈的相关性。ChatGPT情绪得分对股票市场的每日回报具有统计上显著的预测能力。论文还检验了ChatGPT和其他情绪分析方法进行了对比，ChatGPT模型在预测股票市场回报方面表现更好。

![figure](/assets/images/posts/100104-02.png)

如图展示了不考虑交易费用的不同交易策略的结果。我们假定如果一条新闻在市场收盘前披露，我们会在市场收盘价买入（或卖空）一个头寸。如果一条新闻在市场收盘后公布，我们假定我们会在第二天开盘价买入（或卖空）一个头寸。所有策略都每日重新平衡。黑线“All-news”表示前一日有新闻的所有公司等权重组成的组合。绿线表示按照ChatGPT 3.5的判断买入有好消息的公司的等权重组合。红线表示按照ChatGPT 3.5的判断卖空有坏消息的公司的等权重组合。浅蓝线表示按照ChatGPT 3.5的判断买入有好消息的公司并卖空有坏消息的公司且组合成本为零的等权重组合。深蓝线表示按照ChatGPT 4的判断买入有好消息的公司并卖空有坏消息的公司且组合成本为零的等权重组合。黄线表示等权重市场组合。紫线表示价值加权市场组合。可以看到，最高收益率达到了400%（Long-Short策略）！

## 5 结论

这篇文章的研究结果有几个方面的启示。

首先，它强调了继续探索和开发专门针对金融行业的LLMs(大语言模型)的重要性。随着AI驱动的金融业务的发展，可以设计更复杂的模型来提高金融决策过程的准确性和效率。

其次，未来的研究应该集中于理解LLMs获得其预测能力的机制。通过确定有助于ChatGPT等模型成功预测股票市场回报的因素，研究人员可以开发更有针对性的策略，以改进这些模型并最大限度地提高它们在金融领域中的效用。

此外，随着LLMs在金融行业中的使用，由此对市场动态、价格形成、信息传播和市场稳定性等方面的潜在影响也会变得明显。未来的研究可以探讨LLMs在塑造市场行为方面的作用以及它们对金融系统可能产生的积极和消极后果。

最后，未来的研究可以探索将LLMs与其他机器学习技术和量化模型相结合，创建结合不同方法优势的混合系统。通过利用各种方法的互补能力，研究人员可以进一步增强AI的预测能力。

当然这对于金融从业者未必是什么好事情。高盛已经预测，未来金融业将会有35%的岗位被AI所淘汰。不过与之相对自然也会多出许多岗位，因此也不必悲观，保持学习的动力和激情才是最重要的。


论文下载地址：https://arxiv.org/pdf/2304.07619.pdf